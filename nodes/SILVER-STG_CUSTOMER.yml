fileVersion: 1
id: 0142c77c-55eb-4cbb-8ebe-510ca0e16675
name: STG_CUSTOMER
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    selectDistinct: false
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: SILVER
  materializationType: table
  metadata:
    appliedNodeTests:
      - continueOnFailure: false
        description: ""
        name: Test
        runOrder: After
        templateString: |-
          SELECT 1
          FROM {{this}}
          WHERE C_NAME LIKE 'TEST%'
    columns:
      - appliedColumnTests:
          hasNull: true
          isDistinct: true
        columnReference:
          columnCounter: 733a958f-9994-465e-b463-b37749ef4db7
          stepCounter: 0142c77c-55eb-4cbb-8ebe-510ca0e16675
        config: {}
        dataType: DECIMAL(38,6)
        description: ""
        name: C_CUSTKEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 55b9ef98-7923-4f37-b9da-ba36f840fd92
                stepCounter: fa3f50f1-2853-4fd3-bfc7-7e9f99dd8782
            transform: ""
      - appliedColumnTests:
          hasNull: false
          isDistinct: false
        columnReference:
          columnCounter: acec1259-c272-4829-bc5b-cfb3528fbe1d
          stepCounter: 0142c77c-55eb-4cbb-8ebe-510ca0e16675
        config: {}
        dataType: VARCHAR(8000)
        description: ""
        name: C_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f530d5bd-7556-4bdb-9d76-9b4fecc3120d
                stepCounter: fa3f50f1-2853-4fd3-bfc7-7e9f99dd8782
            transform: UPPER([CUSTOMER].[C_NAME])
      - appliedColumnTests:
          hasNull: false
          isDistinct: false
        columnReference:
          columnCounter: 66ec39a3-fdb7-4394-9891-937741b7e5a8
          stepCounter: 0142c77c-55eb-4cbb-8ebe-510ca0e16675
        config: {}
        dataType: VARCHAR(8000)
        description: ""
        name: C_ADDRESS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0053b9e0-9b5a-4e0e-a81a-8745822988c6
                stepCounter: fa3f50f1-2853-4fd3-bfc7-7e9f99dd8782
            transform: UPPER([CUSTOMER].[C_ADDRESS])
      - appliedColumnTests:
          hasNull: false
          isDistinct: false
        columnReference:
          columnCounter: f6103db8-e50c-4eaf-ac41-10357a15a238
          stepCounter: 0142c77c-55eb-4cbb-8ebe-510ca0e16675
        config: {}
        dataType: DECIMAL(38,6)
        description: ""
        name: C_NATIONKEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fc3ceae7-48d2-4c13-8fb6-83a6be0315c9
                stepCounter: fa3f50f1-2853-4fd3-bfc7-7e9f99dd8782
            transform: ""
      - appliedColumnTests:
          hasNull: false
          isDistinct: false
        columnReference:
          columnCounter: c67011a5-f88e-4206-8705-1763b7624e05
          stepCounter: 0142c77c-55eb-4cbb-8ebe-510ca0e16675
        config: {}
        dataType: VARCHAR(8000)
        description: ""
        name: C_PHONE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5a3eac3a-dae7-434d-8281-a99e5ff6cd1e
                stepCounter: fa3f50f1-2853-4fd3-bfc7-7e9f99dd8782
            transform: UPPER([CUSTOMER].[C_PHONE])
      - appliedColumnTests:
          hasNull: false
          isDistinct: false
        columnReference:
          columnCounter: 99d78eae-3941-42fb-8817-ae3385e048f8
          stepCounter: 0142c77c-55eb-4cbb-8ebe-510ca0e16675
        config: {}
        dataType: DECIMAL(38,6)
        description: ""
        name: C_ACCTBAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7ad9b4af-f740-4b9f-8719-e4b846f0a1a5
                stepCounter: fa3f50f1-2853-4fd3-bfc7-7e9f99dd8782
            transform: ""
      - appliedColumnTests:
          hasNull: false
          isDistinct: false
        columnReference:
          columnCounter: e3714094-76b4-41cf-ac0c-e35a2994b230
          stepCounter: 0142c77c-55eb-4cbb-8ebe-510ca0e16675
        config: {}
        dataType: VARCHAR(8000)
        description: ""
        name: C_MKTSEGMENT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b83d8728-8d02-4ba3-a612-ba7f5a3b72ff
                stepCounter: fa3f50f1-2853-4fd3-bfc7-7e9f99dd8782
            transform: UPPER([CUSTOMER].[C_MKTSEGMENT])
      - appliedColumnTests:
          hasNull: false
          isDistinct: false
        columnReference:
          columnCounter: c35b4784-ed52-4890-84d3-983978e39ec1
          stepCounter: 0142c77c-55eb-4cbb-8ebe-510ca0e16675
        config: {}
        dataType: VARCHAR(8000)
        description: ""
        name: C_COMMENT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a9cbd21d-ee40-4bd7-b995-ea1c85e02026
                stepCounter: fa3f50f1-2853-4fd3-bfc7-7e9f99dd8782
            transform: UPPER([CUSTOMER].[C_COMMENT])
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests:
          hasNull: false
          isDistinct: false
        columnReference:
          columnCounter: 0376f4b9-e0df-4cf9-8042-d0d44d8b4fa4
          stepCounter: 0142c77c-55eb-4cbb-8ebe-510ca0e16675
        config: {}
        dataType: VARCHAR(8000)
        defaultValue: ""
        description: ""
        keyColumnType: None
        name: CUST_CAT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: |-
              CASE WHEN [CUSTOMER].[C_ACCTBAL] > 5000 THEN 'HIGH'
              ELSE 'LOW'
              END
        systemColumnType: None
    cteString: ""
    enabledColumnTestIDs:
      - hasNull
      - isDistinct
    sourceMapping:
      - aliases: {}
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: BRONZE
            nodeName: CUSTOMER
        join:
          joinCondition: FROM {{ ref('BRONZE', 'CUSTOMER') }} [CUSTOMER]
        name: STG_CUSTOMER
        noLinkRefs: []
  name: STG_CUSTOMER
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
