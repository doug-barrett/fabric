fileVersion: 1
id: 67622af4-f566-4833-8d31-c51b3167d736
name: DIM_CUSTOMER
operation:
  config:
    insertStrategy: UNION ALL
    postSQL: ""
    preSQL: ""
    selectDistinct: false
    testsEnabled: false
    truncateBefore: false
  database: ""
  deployEnabled: true
  description: This SQL Node drops and creates the DIM_CUSTOMER table, then inserts new records and updates rows based on type-2 and non-type-2 column changes, using data from the STG_CUSTOMER table.
  isMultisource: false
  locationName: GOLD
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 4ee84fbd-b828-4b03-8867-4777acc4c448
          stepCounter: 67622af4-f566-4833-8d31-c51b3167d736
        config: {}
        dataType: DECIMAL
        defaultValue: ""
        description: |-
          The dimension customer key is a system-generated surrogate key that uniquely identifies each record in the dimension table.
          - It has no source column.
          - This key is essential for joining this dimension with fact tables, enabling efficient data retrieval and analysis in downstream reports and BI tools.
          - Being a surrogate key, it has no business meaning but ensures uniqueness and stability for relationships within the data warehouse.
          - It is automatically generated by the system.
        isSurrogateKey: true
        name: DIM_CUSTOMER_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ea295622-6a64-4603-8ace-f716bf943a21
          stepCounter: 67622af4-f566-4833-8d31-c51b3167d736
        config: {}
        dataType: DECIMAL(38,6)
        description: |-
          The customer key, sourced from the 'C_CUSTKEY' column of the 'CUSTOMER' table in the Bronze layer, uniquely identifies each customer.
          - As a primary identifier, it links customer information across various systems and supports customer-centric analyses.
          - This column is essential for creating customer-level reports, segmenting customer data, and calculating customer-related KPIs.
          - Data engineers can use this to establish relationships with other tables and ensure data integrity across the data warehouse.
        isBusinessKey: true
        name: C_CUSTKEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d473a6c3-1523-4ccb-863f-c232a8bcf7f9
                stepCounter: 1678afb8-62ca-43ed-a879-d0e4f1e8728e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6a819d92-faf7-4159-8deb-3882fe980ac6
          stepCounter: 67622af4-f566-4833-8d31-c51b3167d736
        config: {}
        dataType: VARCHAR(8000)
        description: |-
          The customer name, derived from the 'C_NAME' column in the 'CUSTOMER' table (Bronze layer), represents the name of the customer.
          - The transformation 'UPPER' is applied to convert names to uppercase.
          - This column is used in customer identification, personalized marketing campaigns, and customer service applications.
          - It supports creating customer lists, filtering customers by name, and improving data consistency for reporting purposes.
        name: C_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a932a41d-0d9a-4685-bcfd-14396fdd3f18
                stepCounter: 1678afb8-62ca-43ed-a879-d0e4f1e8728e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5510fe0f-4c12-4bde-9ddb-8d37a41ccdd9
          stepCounter: 67622af4-f566-4833-8d31-c51b3167d736
        config: {}
        dataType: VARCHAR(8000)
        description: |-
          The customer address, sourced from the 'C_ADDRESS' column of the 'CUSTOMER' table in the Bronze layer, indicates the physical address of the customer.
          - It is used for location-based analysis, targeted marketing, and shipping logistics.
          - This column can be used to generate reports on customer distribution, calculate regional sales metrics, and improve delivery efficiency.
          - The column is directly sourced without transformations.
        name: C_ADDRESS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 68a78d4c-808a-4ee6-ac2b-e06df65774f4
                stepCounter: 1678afb8-62ca-43ed-a879-d0e4f1e8728e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 87180b05-6638-4186-b0d6-8d9ad9a9d396
          stepCounter: 67622af4-f566-4833-8d31-c51b3167d736
        config: {}
        dataType: DECIMAL(38,6)
        description: |-
          The nation key, sourced from the 'C_NATIONKEY' column of the 'CUSTOMER' table in the Bronze layer, is a foreign key that links to the 'NATION' table.
          - It represents the nation in which the customer resides and enables geographic segmentation of customer data.
          - It can be used to generate reports on sales by nation, analyze customer demographics, and support international marketing strategies.
          - As a foreign key, it ensures referential integrity between the 'CUSTOMER' and 'NATION' tables.
        name: C_NATIONKEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9a321995-00ab-4e40-b2de-4687ab80772e
                stepCounter: 1678afb8-62ca-43ed-a879-d0e4f1e8728e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7f4d45fb-ada6-4fa7-a344-5e0ee38f3c42
          stepCounter: 67622af4-f566-4833-8d31-c51b3167d736
        config: {}
        dataType: VARCHAR(8000)
        description: |-
          The customer phone number, sourced from the 'C_PHONE' column of the 'CUSTOMER' table in the Bronze layer, represents the contact number for the customer.
          - It is used for direct communication, customer support, and marketing campaigns.
          - This column enables customer outreach programs, facilitates customer service interactions, and helps maintain accurate customer contact information.
          - The column is directly sourced without transformations.
        name: C_PHONE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4746e9d4-22c8-4efa-a36d-4aae6226fa4d
                stepCounter: 1678afb8-62ca-43ed-a879-d0e4f1e8728e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 79f91dc3-dc95-4b89-8fe4-924dfbeca2db
          stepCounter: 67622af4-f566-4833-8d31-c51b3167d736
        config: {}
        dataType: DECIMAL(38,6)
        description: |-
          The customer account balance, sourced from the 'C_ACCTBAL' column of the 'CUSTOMER' table in the Bronze layer, indicates the current balance of the customer's account.
          - It is used for financial analysis, credit risk assessment, and customer segmentation based on account value.
          - This column supports generating reports on customer account distribution, calculating average account balances, and identifying high-value customers.
          - The column is directly sourced without transformations.
        name: C_ACCTBAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9ffb8cda-498b-446c-be83-07aba7668dd6
                stepCounter: 1678afb8-62ca-43ed-a879-d0e4f1e8728e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: abb7bc91-7b0e-47e7-abcc-ccee255db967
          stepCounter: 67622af4-f566-4833-8d31-c51b3167d736
        config: {}
        dataType: VARCHAR(8000)
        description: |-
          The market segment, sourced from the 'C_MKTSEGMENT' column of the 'CUSTOMER' table in the Bronze layer, categorizes customers based on their market segment.
          - It enables targeted marketing campaigns, product development, and sales strategies tailored to specific market segments.
          - This column supports analyzing sales performance by market segment, identifying growth opportunities, and optimizing marketing spend.
          - The column is directly sourced without transformations.
        name: C_MKTSEGMENT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b62ae415-579d-4e7a-9bd7-735326f79a52
                stepCounter: 1678afb8-62ca-43ed-a879-d0e4f1e8728e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7dd71aec-e305-4092-96c6-b470a7d97d3d
          stepCounter: 67622af4-f566-4833-8d31-c51b3167d736
        config: {}
        dataType: VARCHAR(8000)
        description: |-
          The customer comment, sourced from the 'C_COMMENT' column of the 'CUSTOMER' table in the Bronze layer, contains descriptive information or notes about the customer.
          - It is used for additional customer insights, special handling instructions, or tracking specific customer requirements.
          - This column enables personalized customer service, helps resolve customer issues, and provides context for customer interactions.
          - The column is directly sourced without transformations.
        name: C_COMMENT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f334bdad-dd0d-4943-afb3-0298059c20f8
                stepCounter: 1678afb8-62ca-43ed-a879-d0e4f1e8728e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d374dc1b-e57e-45ab-8fac-369acf8dc40d
          stepCounter: 67622af4-f566-4833-8d31-c51b3167d736
        config: {}
        dataType: VARCHAR(8000)
        description: |-
          The customer category, derived from the 'C_ACCTBAL' column of the 'CUSTOMER' table, categorizes customers into 'HIGH' or 'LOW' based on their account balance.
          - If the account balance is greater than 5000, the customer is categorized as 'HIGH'; otherwise, 'LOW'.
          - This column is used for customer segmentation, targeted marketing, and differentiated service offerings.
          - It supports analyzing customer behavior by category, identifying high-value customers, and tailoring marketing strategies.
        name: CUST_CAT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bfa2688e-a085-48e1-af4d-5b66d1cb0124
                stepCounter: 1678afb8-62ca-43ed-a879-d0e4f1e8728e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bba2795c-0137-4dc7-b90a-4c3b06f0cdc2
          stepCounter: 67622af4-f566-4833-8d31-c51b3167d736
        config: {}
        dataType: VARCHAR(8000)
        description: |-
          The nation name, sourced from the 'N_NAME' column of the 'NATION' table in the Bronze layer, represents the name of the nation.
          - It is used for geographic analysis, international reporting, and understanding global market trends.
          - This column supports generating reports on sales by nation, analyzing demographic data, and developing international business strategies.
          - The column is directly sourced without transformations.
        name: NATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4c659adc-c75e-4037-a821-c5d29320bc09
                stepCounter: 1678afb8-62ca-43ed-a879-d0e4f1e8728e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 04ebd717-0edd-48ed-ad5c-4892abc4cefd
          stepCounter: 67622af4-f566-4833-8d31-c51b3167d736
        config: {}
        dataType: VARBINARY(8000)
        description: ""
        isChangeTracking: true
        name: CUSTOMER_HASH
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c7e9361e-fc50-47f2-b364-5e270854e5e0
                stepCounter: 1678afb8-62ca-43ed-a879-d0e4f1e8728e
            transform: ""
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: e34a38a9-7977-4e59-a721-4059e3c182ee
          stepCounter: 67622af4-f566-4833-8d31-c51b3167d736
        config: {}
        dataType: DECIMAL
        defaultValue: ""
        description: |-
          This column is a system-generated version number that tracks changes to the record over time.
          - It has no source column.
          - It is automatically incremented each time the record is updated, allowing for historical analysis and auditing.
          - Data engineers can use this to identify the sequence of changes and maintain data lineage.
          - Business users can use it to understand when data was updated.
        isSystemVersion: true
        name: SYSTEM_VERSION
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: aa1d73b7-2c76-419c-a5a1-9bb8edb44b39
          stepCounter: 67622af4-f566-4833-8d31-c51b3167d736
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: |-
          This column is a system-generated flag indicating whether the record is the most current version.
          - It has no source column.
          - It is set to 'Y' for the current record and 'N' for historical records, enabling easy identification of the latest data.
          - Data engineers can use this flag to filter current records and perform point-in-time analysis.
          - Business users can rely on this flag to ensure they are working with the most up-to-date information.
        isSystemCurrentFlag: true
        name: SYSTEM_CURRENT_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: cb816f0a-4166-47cc-8c6a-77d508d3717d
          stepCounter: 67622af4-f566-4833-8d31-c51b3167d736
        config: {}
        dataType: DATETIME2(3)
        defaultValue: ""
        description: |-
          This column is a system-generated timestamp indicating the date and time when the record became active.
          - It has no source column.
          - It is automatically populated with the current date and time when the record is created or updated.
          - Data engineers can use this to track the effective start date of a record's validity.
          - Business users can use it to understand when a record became relevant.
        isSystemStartDate: true
        name: SYSTEM_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: CAST(GETDATE() AS DATETIME2(3))
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: b2d508dc-69b7-4053-b7df-0d0c4aee825b
          stepCounter: 67622af4-f566-4833-8d31-c51b3167d736
        config: {}
        dataType: DATETIME2(3)
        defaultValue: ""
        description: |-
          This column is a system-generated timestamp indicating the date and time when the record became inactive.
          - It has no source column.
          - It is automatically populated with a default end date ('2999-12-31') upon record creation and updated when the record is superseded.
          - Data engineers can use this to track the effective end date of a record's validity.
          - Business users can use it to understand when a record is no longer relevant.
        isSystemEndDate: true
        name: SYSTEM_END_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: CAST('2999-12-31 00:00:00' AS DATETIME2(3))
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: fb141d98-9ec1-4436-baef-1af26ea525fd
          stepCounter: 67622af4-f566-4833-8d31-c51b3167d736
        config: {}
        dataType: DATETIME2(3)
        defaultValue: ""
        description: |-
          This column is a system-generated timestamp indicating when the record was initially created.
          - It has no source column.
          - It captures the exact date and time of record creation, providing a historical reference.
          - Data engineers can use this for auditing and tracking data ingestion processes.
          - Business users can reference this to understand when the data was first introduced into the system.
        isSystemCreateDate: true
        name: SYSTEM_CREATE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: CAST(GETDATE() AS DATETIME2(3))
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 81785598-e5ad-4ead-846c-dbc5c2f84aa5
          stepCounter: 67622af4-f566-4833-8d31-c51b3167d736
        config: {}
        dataType: DATETIME2(3)
        defaultValue: ""
        description: |-
          This column is a system-generated timestamp indicating the last time the record was updated.
          - It has no source column.
          - It captures the exact date and time of the most recent modification, facilitating change tracking.
          - Data engineers can use this for auditing and monitoring data quality.
          - Business users can reference this to understand when the data was last modified.
        isSystemUpdateDate: true
        name: SYSTEM_UPDATE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: CAST(GETDATE() AS DATETIME2(3))
    cteString: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases: {}
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: SILVER
            nodeName: STG_CUSTOMER
        join:
          joinCondition: FROM {{ ref('SILVER', 'STG_CUSTOMER') }} [STG_CUSTOMER]
        name: DIM_CUSTOMER
        noLinkRefs: []
  name: DIM_CUSTOMER
  overrideSQL: false
  schema: ""
  sqlType: Dimension
  type: sql
  version: 1
type: Node
